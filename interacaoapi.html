<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<title>Gerenciador de Tarefas</title>
</head>
<body>
<h1>Minha Lista de Tarefas</h1>

<ul id="lista-tarefas"></ul>

<h2>Adicionar Nova Tarefa</h2>
<input type="text" id="titulo" placeholder="Título" />
<input type="text" id="descricao" placeholder="Descrição" />
<button onclick="adicionarTarefa()">Adicionar</button>

<script>
const apiUrl = 'http://localhost:3000/tarefas';

// Função para listar tarefas
function listarTarefas() {
  fetch(apiUrl)
    .then(res => res.json())
    .then(tarefas => {
      const lista = document.getElementById('lista-tarefas');
      lista.innerHTML = '';
      tarefas.forEach(tarefa => {
        const li = document.createElement('li');
        li.textContent = `${tarefa.titulo} - ${tarefa.descricao} (${tarefa.concluida ? 'Concluída' : 'Pendente'})`;

        // Botão para excluir
        const btnExcluir = document.createElement('button');
        btnExcluir.textContent = 'Excluir';
        btnExcluir.onclick = () => excluirTarefa(tarefa.id);
        li.appendChild(btnExcluir);

        // Checkbox para concluir
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = tarefa.concluida;
        checkbox.onchange = () => atualizarStatus(tarefa.id, checkbox.checked);
        li.appendChild(checkbox);

        lista.appendChild(li);
      });
    });
}

// Função para adicionar uma nova tarefa
function adicionarTarefa() {
  const titulo = document.getElementById('titulo').value;
  const descricao = document.getElementById('descricao').value;
  fetch(apiUrl, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ titulo, descricao })
  }).then(() => {
    listarTarefas();
  });
}

// Função para excluir uma tarefa
function excluirTarefa(id) {
  fetch(`${apiUrl}/${id}`, { method: 'DELETE' }).then(() => {
    listarTarefas();
  });
}

// Função para atualizar o status (concluído ou não)
function atualizarStatus(id, concluida) {
  fetch(`${apiUrl}/${id}`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ concluida })
  }).then(() => {
    listarTarefas();
  });
}

// Carregar tarefas ao abrir a página
listarTarefas();
</script>
</body>
</html>
